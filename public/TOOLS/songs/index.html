<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <title>ntdMusic</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <link rel="stylesheet" href="css/styles.css">
</head>

<body>
  <header>
    <div>
      <span><i class="fa-solid fa-music"></i></span> <span class="logoweb" onclick="location.reload()">ntdMUSIC</span>
      <span style="font-size: medium; color: rgba(255,255,255,0.5);"><span class="rauMa" onclick="alert('B·∫•m v√¥ ƒë√¢y l√†m c√°i ch√≥ g√¨??? Var h·∫£???')">36</span></span>
    </div>
    <div class="search-container">
      <input type="text" id="searchInput" class="search-input" placeholder="üîé T√¨m theo t√™n, ca sƒ©, s√°ng t√°c ho·∫∑c l·ªùi b√†i h√°t..." />
      <select id="artistFilter" class="artist-filter">
        <option value="">-- T·∫•t c·∫£ ca sƒ© --</option>
        <!-- Options s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông t·ª´ JS -->
      </select>
    </div>
    <div id="authButtons" style="display: flex; align-items: center; gap: 12px;">
      <button class="btn btn-add" onclick="loginDialog.showModal()" id="btn-login" title="ƒêƒÉng nh·∫≠p">
        <i class="fa-solid fa-user"></i>
      </button>
      <button class="btn btn-add" onclick="toggleSidebar()" id="btn-menu-guest" title="Menu">
        <i class="fa-solid fa-bars"></i>
      </button>
    </div>
    <div id="userInfo" style="display: none; align-items: center; gap: 12px;">
      <span id="userDisplayName" style="font-size: 26px;"></span>
      <button class="btn btn-add" onclick="showViewProfile()" id="btn-info-sc" title="Th√¥ng tin t√†i kho·∫£n">
        <i class="fa-solid fa-user"></i>
      </button>
      <button class="btn btn-add" onclick="handleLogout()" id="btn-logout" title="ƒêƒÉng xu·∫•t">
        <i class="fa-solid fa-right-from-bracket"></i>
      </button>
      <button class="btn btn-add" onclick="toggleSidebar()" id="btn-menu" title="Menu">
        <i class="fa-solid fa-bars"></i>
      </button>
    </div>
  </header>

<!-- Sidebar Menu -->
<div id="sidebar" class="sidebar">
  <div class="sidebar-header">
    <h3>Menu</h3>
    <button class="btn-close-sidebar" onclick="toggleSidebar()">
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="sidebar-content">
    Song
    <button class="sidebar-item" id="btn-reload-sc" onclick="location.reload(); toggleSidebar();">
      <i class="fa-solid fa-arrow-rotate-right"></i>
      <span>L√†m m·ªõi</span>
    </button>
    <button class="sidebar-item" id="btn-add-sc" onclick="addSongDialog.showModal(); toggleSidebar();">
      <i class="fa-solid fa-plus"></i>
      <span>Th√™m b√†i h√°t</span>
    </button>
    Feature other
    <button class="sidebar-item" id="btn-youtube-sc" onclick="openYoutubeSearchDialog(); toggleSidebar();">
      <i class="fa-brands fa-youtube"></i>
      <span>T√¨m video YouTube</span>
    </button>
    <button class="sidebar-item" id="btn-hoiAI-sc" onclick="hoiAI(); toggleSidebar();">
      <i class="fa-solid fa-robot"></i>
      <span>H·ªèi AI</span>
    </button>
    <button class="sidebar-item" id="btn-home-sc" onclick="window.open('https://2937.vercel.app'); toggleSidebar();">
      <i class="fa-solid fa-house"></i>
      <span>Trang ch·ªß</span>
    </button>
    <button class="sidebar-item" id="btn-settings-sc" onclick="openSettingsDialog(); toggleSidebar();">
      <i class="fa-solid fa-gear"></i>
      <span>C√†i ƒë·∫∑t</span>
    </button>
    <button class="sidebar-item" id="btn-history-sc" onclick="openHistoryDialog(); toggleSidebar();">
      <i class="fa-solid fa-clock-rotate-left"></i>
      <span>L·ªãch s·ª≠ th√™m b√†i</span>
    </button>
    <button class="sidebar-item" id="btn-album-sc" onclick="openAlbumDialog(); toggleSidebar();">
      <i class="fa-solid fa-compact-disc"></i>
      <span>Danh s√°ch Album</span>
    </button>
    Social
    <button class="sidebar-item" id="btn-rank-sc" onclick="openRankingDialog(); toggleSidebar();">
      <i class="fa-solid fa-ranking-star"></i>
      <span>B·∫£ng x·∫øp h·∫°ng</span>
    </button>
    <button class="sidebar-item" id="btn-streak-sc" onclick="checkStreak(); toggleSidebar();">
      <i class="fa-solid fa-fire"></i>
      <span id="streakText">ƒêi·ªÉm danh h√†ng ng√†y</span>
    </button>
    <button class="sidebar-item" id="btn-favourite-sc" onclick="openFavouriteDialog(); toggleSidebar();">
      <i class="fa-solid fa-heart"></i>
      <span>B√†i h√°t y√™u th√≠ch</span>
    </button>
    About
    <button class="sidebar-item" id="btn-guide-sc" onclick="openGuideDialog(); toggleSidebar();">
      <i class="fa-solid fa-circle-info"></i>
      <span>H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</span>
    </button>
    <button class="sidebar-item" id="btn-updates-sc" onclick="openUpdatesDialog(); toggleSidebar();">
      <i class="fa-solid fa-bullhorn"></i>
      <span>Th√¥ng tin c·∫≠p nh·∫≠t</span>
    </button>
  </div>
</div>

<!-- Overlay -->
<div id="sidebar-overlay" class="sidebar-overlay" onclick="toggleSidebar()"></div>

<div class="filter-section">
  <div class="tag-filter-container">
    <div class="tag-filter-label">
      <i class="fa-solid fa-filter"></i>
      <span>L·ªçc theo tag:</span>
    </div>
    <div class="tag-filter-options" id="tagFilterOptions">
      <!-- Tags s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông t·ª´ JS -->
    </div>
    <button class="btn-clear-filter" id="btnClearTagFilter" style="display: none;">
      <i class="fa-solid fa-xmark"></i> X√≥a b·ªô l·ªçc
    </button>
  </div>
</div>

  <main>
    <div class="stats-container">
      <div class="stat-card">
        <div class="stat-icon">üéµ</div>
        <div class="stat-content">
          <div class="stat-label">T·ªïng s·ªë b√†i h√°t</div>
          <div class="stat-value" id="totalSongs">0</div>
        </div>
      </div>
    
      <!-- TH√äM CARD STREAK M·ªöI -->
      <div class="stat-card streak-card" onclick="checkStreak()" style="cursor: pointer;">
        <div class="stat-icon">üî•</div>
        <div class="stat-content">
          <div class="stat-label" id="streakLabel">Ch∆∞a c√≥ streak</div>
          <div class="stat-value" id="streakValue">0 ng√†y</div>
        </div>
      </div>
      
      <div class="stat-card mfy-card" id="mfyCard" onclick="showmfyDetail()" style="cursor: pointer;">
        <div class="stat-icon">‚≠ê</div>
        <div class="stat-content">
          <div class="stat-label">Music for YOU</div>
          <div class="stat-value" id="mfySong">---</div>
          <div class="mfy-lyric" id="mfyLyric"></div>
        </div>
      </div>
    </div>
    <table>
      <thead>
        <tr>
          <th>Avatar</th>
          <th>T√™n b√†i h√°t</th>
          <th>Ca sƒ©</th>
          <th>S√°ng t√°c</th>
          <th>Ng√†y ph√°t h√†nh</th>
          <th>Hot</th>
          <th>Thao t√°c</th>
        </tr>
      </thead>
      <tbody id="list"></tbody>
      <tbody>
        <tr>
          <th> </th>
          <th> </th>
          <th> </th>
          <th> </th>
          <th> </th>
          <th> </th>
          <th> </th>
        </tr>
      </tbody>
      <tbody>
        <tr>
          <th> </th>
          <th> </th>
          <th> </th>
          <th> </th>
          <th> </th>
          <th> </th>
          <th> </th>
        </tr>
      </tbody>
    </table>
  </main>
  <dialog id="lyricDialog">
    <button class="btn close" onclick="lyricDialog.close()">
      <span style="font-size: 30px;" id="closeNew">+</span>
    </button>
    <h2 id="dTitle"></h2>
    <div class="lyric-container">
      <div class="lyric-avatar">
        <img id="dAvatar" src="" alt="avatar" style="display: none" />
        <hr width="100%" color="white" style="border: none; height: 1px; margin: 32px 0; background-color: white; opacity: 1;">
        <div style="font-weight: 700; text-align: center; font-style: italic;">Nghe nh·∫°c</div>
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/84/Spotify_icon.svg/250px-Spotify_icon.svg.png" class="iconMXH" onclick="spotifyThismusic()" />
        <img src="https://dangcapdigital.vn/img/app/zingmp3-aszyd.png" class="iconMXH" onclick="zingmp3Thismusic()" />
        <img src="https://upload.wikimedia.org/wikipedia/commons/2/2b/NhacCuaTui_2022logo.png" class="iconMXH" onclick="nctThismusic()" />
        <hr width="100%" color="white" style="border: none; height: 1px; margin: 32px 0; background-color: white; opacity: 1;">
        <div style="font-weight: 700; text-align: center; font-style: italic;">Xem MV / Video</div>
        <img src="https://upload.wikimedia.org/wikipedia/commons/e/ef/Youtube_logo.png" class="iconMXH" onclick="youtubeThismusic()" />
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQiXN9xSEe8unzPBEQOeAKXd9Q55efGHGB9BA&s" class="iconMXH" onclick="facebookThismusic()" />
        <img src="https://p16-tiktokcdn-com.akamaized.net/obj/tiktok-obj/32f2ab89bf0d9acee8ff3021890559a7.png" class="iconMXH" onclick="tiktokThismusic()" />

  <button onclick="openYoutubeVideoDialog()" style="
    width: 90%;
    padding: 12px 24px;
    background: linear-gradient(135deg, #ff0000, #cc0000);
    border: none;
    border-radius: 12px;
    color: white;
    font-weight: 600;
    cursor: pointer;
    font-size: 16px;
    margin: 12px auto;
    display: block;
    transition: all 0.3s;
  " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(255,0,0,0.4)'" 
     onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
    <i class="fa-brands fa-youtube"></i> Xem Video Tr√™n Web
  </button>

      </div>
      <div class="lyric-content">
        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 8px;">
          <p id="dArtist" style="margin: 0; flex: 1;"></p>
          <button 
            id="btnFavouriteLyric" 
            onclick="toggleFavourite()" 
            class="btn-favourite"
            title="Y√™u th√≠ch"
          >
            <i class="fa-solid fa-heart"></i>
          </button>
        </div>
        <p id="dDate"></p>
        <p id="dAlbum"></p>
        <p id="dAddedBy"></p>
        <pre id="dLyric"></pre>
      </div>
      </div>
    </div>
  </dialog>
  <dialog id="addSongDialog">
    <button class="btn close" onclick="addSongDialog.close()">
      <span style="font-size: 30px;" id="closeNew">+</span>
    </button>
    <h2>Th√™m b√†i h√°t m·ªõi</h2>
    <form id="songForm">
      <div class="form-group">
        <a href="https://www.google.com/search?q=b%C3%A0i+h%C3%A1t+hot+nh%E1%BA%A5t+tiktok+hi%E1%BB%87n+t%E1%BA%A1i" target="_blank" class="goiy">G·ª£i √Ω</a>
        <label for="songName">T√™n b√†i h√°t *</label>
        <input type="text" id="songName" placeholder="Nh·∫≠p t√™n b√†i h√°t" required />
        <div class="error" id="error-songName"></div>
      </div>
      <div class="form-group">
        <a href="#" class="goiy" onclick="timCasi()">Kh√¥ng bi·∫øt t√™n ca sƒ©?</a>
        <label for="artist">Ca sƒ© *</label>
        <input type="text" id="artist" placeholder="Nh·∫≠p t√™n ca sƒ©" required />
        <div class="error" id="error-artist"></div>
      </div>
      <div class="form-group">
        <a href="#" class="goiy" onclick="timSangtac()">Kh√¥ng bi·∫øt ai s√°ng t√°c?</a>
        <label for="composer">S√°ng t√°c *</label>
        <input type="text" id="composer" placeholder="Nh·∫≠p t√™n ng∆∞·ªùi s√°ng t√°c" required />
        <div class="error" id="error-composer"></div>
      </div>
      <div class="form-group">
        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; text-transform: none; font-size: 15px;">
          <input type="checkbox" id="hasAlbum" style="width: auto; cursor: pointer; accent-color: var(--accent-primary);">
          <span>B√†i h√°t n·∫±m trong album</span>
        </label>
      </div>
      <div class="form-group" id="albumGroup" style="display: none;">
        <a href="#" class="goiy" onclick="timAlbum()">T√¨m album</a>
        <label for="album">T√™n Album</label>
        <input type="text" id="album" placeholder="Nh·∫≠p t√™n album" />
        <div class="error" id="error-album"></div>
      </div>
      <div class="form-group">
        <a href="#" class="goiy" onclick="timLinkbaihat()">T√¨m link b√†i h√°t</a>
        <label>Link YouTube (ch·ªâ c·∫ßn khi th·∫•y ng√†y ph√°t h√†nh b·ªã sai)</label>
        <div style="display:flex; gap:8px">
          <input type="url" id="youtubeLinkAdd" placeholder="https://www.youtube.com/watch?v=..." />
          <button type="button" class="btn" onclick="fetchYoutubeDate('add')" style="padding: 0 14px">
            üìÖ
          </button>
        </div>
      </div>

      <div class="form-group">
        <a href="#" class="goiy" onclick="timNgayphathanh()">Kh√¥ng bi·∫øt ng√†y ph√°t h√†nh?</a>
        <label for="releaseDate">Ng√†y ph√°t h√†nh *</label>
        <div style="display:flex; gap:8px">
          <input type="date" id="releaseDate" required />
          <button type="button" class="btn" title="T·ª± t√¨m ng√†y ph√°t h√†nh theo t√™n b√†i h√°t" onclick="autoFindReleaseDate()" style="padding: 0 14px">
            üîç
          </button>
        </div>

        <div class="error" id="error-releaseDate"></div>
      </div>
      <div class="form-group">
        <a href="#" onclick="timAvatar1()" class="goiy">T√¨m avatar</a>
        <label for="avatar">URL Avatar</label>
        <input type="url" id="avatar" placeholder="Nh·∫≠p link/url c·ªßa ·∫£nh" />
        <div class="error" id="error-avatar"></div>
      </div>
      <div class="form-group">
        <a href="#" class="goiy" onclick="timLoibaihat()">T√¨m l·ªùi b√†i h√°t</a>
        <label for="lyric">L·ªùi b√†i h√°t</label>
        <textarea id="lyric" placeholder="Nh·∫≠p l·ªùi b√†i h√°t ƒë√£ sao ch√©p"></textarea>
        <div class="error" id="error-lyric"></div>
      </div>

      <div class="form-group">
        <a href="#" class="goiy" onclick="timTag()">T√¨m th·ªÉ lo·∫°i</a>
        <label>Tags (Ch·ªçn c√°c tag ph√π h·ª£p)</label>
        <div class="tag-selector" id="tagSelector">
          <div class="tag-option" data-tag="Sad">Sad</div>
          <div class="tag-option" data-tag="Happy">Happy</div>
          <div class="tag-option" data-tag="Love">Love</div>
          <div class="tag-option" data-tag="V-pop">V-pop</div>
          <div class="tag-option" data-tag="Rap">Rap</div>
          <div class="tag-option" data-tag="Ballad">Ballad</div>
          <div class="tag-option" data-tag="K-pop">K-pop</div>
          <div class="tag-option" data-tag="Lofi">Lofi</div>
          <div class="tag-option" data-tag="Indie">Indie</div>
          <div class="tag-option" data-tag="Trending">Trending</div>
        </div>

        <input type="hidden" id="selectedTags" value="">
      </div>

      <div class="form-group">
        <label for="addedBy">Ng∆∞·ªùi th√™m</label>
        <input type="text" id="addedBy" readonly style="background: #0f0f12; cursor: not-allowed; opacity: 0.7;" />
        <small style="color: #6b7280; font-size: 14px; margin-top: 4px; display: block;">
          üí° T·ª± ƒë·ªông l·∫•y t·ª´ t√†i kho·∫£n ƒëang ƒëƒÉng nh·∫≠p
        </small>
      </div>

      <div class="form-group">
        <label for="adminCode">M√£ x√°c minh Admin (t√πy ch·ªçn)</label>
        <input type="text" id="adminCode" placeholder="Nh·∫≠p m√£ admin ƒë·ªÉ t·ª± ƒë·ªông x√°c minh" />
        <div class="error" id="error-adminCode"></div>
        <small style="
                            color: #6b7280;
                            font-size: 14px;
                            margin-top: 4px;
                            display: block;
                        ">üí° Nh·∫≠p m√£ admin ƒë·ªÉ b√†i h√°t ƒë∆∞·ª£c x√°c minh ngay l·∫≠p
          t·ª©c</small>
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-cancel" onclick="addSongDialog.close()">
          H·ªßy
        </button>
        <button type="submit" class="btn btn-submit">
          Th√™m b√†i h√°t
        </button>
      </div>
    </form>
  </dialog>

  <dialog id="editSongDialog">
    <button class="btn close" onclick="editSongDialog.close()">
      <span style="font-size: 30px;" id="closeNew">+</span>
    </button>
    <h2>Ch·ªânh s·ª≠a b√†i h√°t</h2>
    <form id="editSongForm">
      <div class="form-group">
        <label for="editSongName">T√™n b√†i h√°t *</label>
        <input type="text" id="editSongName" required />
        <div class="error" id="error-editSongName"></div>
      </div>
      <div class="form-group">
        <label for="editArtist">Ca sƒ© *</label>
        <input type="text" id="editArtist" required />
        <div class="error" id="error-editArtist"></div>
      </div>
      <div class="form-group">
        <label for="editComposer">S√°ng t√°c *</label>
        <input type="text" id="editComposer" required />
        <div class="error" id="error-editComposer"></div>
      </div>
      <div class="form-group">
        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; text-transform: none; font-size: 15px;">
          <input type="checkbox" id="editHasAlbum" style="width: auto; cursor: pointer; accent-color: var(--accent-primary);">
          <span>B√†i h√°t n·∫±m trong album</span>
        </label>
      </div>
      <div class="form-group" id="editAlbumGroup" style="display: none;">
        <a href="#" class="goiy" onclick="timAlbum2()">T√¨m album</a>
        <label for="editAlbum">T√™n Album</label>
        <input type="text" id="editAlbum" placeholder="Nh·∫≠p t√™n album" />
        <div class="error" id="error-editAlbum"></div>
      </div>
      <div class="form-group">
        <label for="editReleaseDate">Ng√†y ph√°t h√†nh *</label>
        <input type="date" id="editReleaseDate" required />
        <div class="error" id="error-editReleaseDate"></div>
      </div>
      <div class="form-group">
        <a href="#" onclick="timAvatar()" class="goiy">T√¨m avatar</a>
        <label for="editAvatar">URL Avatar</label>
        <input type="url" id="editAvatar" />
        <div class="error" id="error-editAvatar"></div>
      </div>
      <div class="form-group">
        <label for="editLyric">L·ªùi b√†i h√°t</label>
        <textarea id="editLyric"></textarea>
        <div class="error" id="error-editLyric"></div>
      </div>
      
      <div class="form-group">
        <a href="#" class="goiy" onclick="timTag2()">T√¨m th·ªÉ lo·∫°i</a>
        <label>Tags (Ch·ªçn c√°c tag ph√π h·ª£p)</label>
        <div class="tag-selector" id="editTagSelector">
          <div class="tag-option" data-tag="Sad">Sad</div>
          <div class="tag-option" data-tag="Happy">Happy</div>
          <div class="tag-option" data-tag="Love">Love</div>
          <div class="tag-option" data-tag="V-pop">V-pop</div>
          <div class="tag-option" data-tag="Rap">Rap</div>
          <div class="tag-option" data-tag="Ballad">Ballad</div>
          <div class="tag-option" data-tag="K-pop">K-pop</div>
          <div class="tag-option" data-tag="Lofi">Lofi</div>
          <div class="tag-option" data-tag="Indie">Indie</div>
          <div class="tag-option" data-tag="Trending">Trending</div>
        </div>
        <input type="hidden" id="editSelectedTags" value="">
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-cancel" onclick="editSongDialog.close()">
          H·ªßy
        </button>
        <button type="submit" class="btn btn-submit">
          C·∫≠p nh·∫≠t b√†i h√°t
        </button>
      </div>
    </form>
  </dialog>

  <dialog id="loginDialog">
    <button class="btn close" onclick="loginDialog.close()">
      <span style="font-size: 30px;" id="closeNew">+</span>
    </button>
    <h2>ƒêƒÉng nh·∫≠p</h2>
    <form id="loginForm">
      <div class="form-group">
        <label for="loginEmail">Email *</label>
        <input type="email" id="loginEmail" required placeholder="example@email.com" />
      </div>
      <div class="form-group">
        <label for="loginPassword">M·∫≠t kh·∫©u *</label>
        <input type="password" id="loginPassword" required />
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-cancel" onclick="loginDialog.close()">H·ªßy</button>
        <button type="submit" class="btn btn-submit">ƒêƒÉng nh·∫≠p</button>
      </div>
      <div style="text-align: center; margin-top: 16px;">
        <a href="#" class="goiy" onclick="event.preventDefault(); loginDialog.close(); registerDialog.showModal()">
          Ch∆∞a c√≥ t√†i kho·∫£n? ƒêƒÉng k√Ω ngay
        </a>
      </div>
    </form>
  </dialog>

  <dialog id="registerDialog">
    <button class="btn close" onclick="registerDialog.close()">
      <span style="font-size: 30px;" id="closeNew">+</span>
    </button>
    <h2>ƒêƒÉng k√Ω t√†i kho·∫£n</h2>
    <form id="registerForm">
      <div class="form-group">
        <label for="regDisplayName">T√™n hi·ªÉn th·ªã * (3~20 k√≠ t·ª±)</label>
        <input type="text" id="regDisplayName" required placeholder="Nguy·ªÖn VƒÉn A" minlength="3" maxlength="20"/>
        <div class="error" id="error-regDisplayName"></div>
      </div>
      <div class="form-group">
        <label for="regEmail">Email *</label>
        <input type="email" id="regEmail" required placeholder="example@email.com" />
        <div class="error" id="error-regEmail"></div>
      </div>
      <div class="form-group">
        <label for="regPhone">S·ªë ƒëi·ªán tho·∫°i *</label>
        <input type="tel" id="regPhone" required placeholder="0912345678" />
        <div class="error" id="error-regPhone"></div>
      </div>
      <div class="form-group">
        <label for="regPassword">M·∫≠t kh·∫©u *</label>
        <input type="password" id="regPassword" required placeholder="T·ªëi thi·ªÉu 6 k√Ω t·ª±" />
        <div class="error" id="error-regPassword"></div>
      </div>
      <div class="form-group">
        <label for="regConfirmPassword">Nh·∫≠p l·∫°i m·∫≠t kh·∫©u *</label>
        <input type="password" id="regConfirmPassword" required />
        <div class="error" id="error-regConfirmPassword"></div>
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-cancel" onclick="registerDialog.close()">H·ªßy</button>
        <button type="submit" class="btn btn-submit">ƒêƒÉng k√Ω</button>
      </div>
      <div style="text-align: center; margin-top: 16px;">
        <a href="#" class="goiy" onclick="event.preventDefault(); registerDialog.close(); loginDialog.showModal()">
          ƒê√£ c√≥ t√†i kho·∫£n? ƒêƒÉng nh·∫≠p
        </a>
      </div>
    </form>
  </dialog>

  <dialog id="viewProfileDialog">
    <button class="btn close" onclick="viewProfileDialog.close()">
      <span style="font-size: 30px;" id="closeNew">+</span>
    </button>
    <h2>Th√¥ng tin t√†i kho·∫£n</h2>
    <div style="padding: 20px;">
      <div style="display: flex; padding: 12px; border-bottom: 1px solid #2a2a33;">
        <label style="flex: 0 0 100px; font-weight: 600; opacity: 0.7;">T√™n hi·ªÉn th·ªã:</label>
        <span id="viewDisplayName"></span>
      </div>
      <div style="display: flex; padding: 12px; border-bottom: 1px solid #2a2a33;">
        <label style="flex: 0 0 100px; font-weight: 600; opacity: 0.7;">Email:</label>
        <span id="viewEmail"></span>
      </div>
      <div style="display: flex; padding: 12px; border-bottom: 1px solid #2a2a33;">
        <label style="flex: 0 0 100px; font-weight: 600; opacity: 0.7;">S·ªë ƒëi·ªán tho·∫°i:</label>
        <span id="viewPhone"></span>
      </div>
      <div style="display: flex; padding: 12px; border-bottom: 1px solid #2a2a33;">
        <label style="flex: 0 0 100px; font-weight: 600; opacity: 0.7;">Vai tr√≤:</label>
        <span id="viewRole"></span>
      </div>
      <div style="display: flex; padding: 12px; border-bottom: 1px solid #2a2a33;">
        <label style="flex: 0 0 100px; font-weight: 600; opacity: 0.7;">L·ªùi nh·∫Øn: </label>
        <span>Qr ƒë∆∞·ªõi ƒë√¢y l√† th√¥ng tin li√™n h·ªá! Kh√¥ng ph·∫£i Qr chuy·ªÉn ti·ªÅn hay thanh to√°n n√™n ƒë·ª´ng lo.</span>
      </div>
      <br>
      <img src="https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=https://www.facebook.com/nthdat.7" alt="QR Facebook" style="text-align: center;padding: 20px; background-color: white;" />
      <div style="margin-top: 24px; text-align: center;">
        <button class="btn btn-submit" onclick="openGopyDialog()" style="margin-right: 8px;">
          <i class="fa-solid fa-comment"></i> G√≥p √Ω
        </button>
        <button class="btn btn-edit" onclick="openEditProfileDialog()">
          <i class="fa-solid fa-pen-to-square"></i> Ch·ªânh s·ª≠a th√¥ng tin
        </button>
      </div>
    </div>
  </dialog>

  <dialog id="editProfileDialog">
    <button class="btn close" onclick="editProfileDialog.close()">
      <span style="font-size: 30px;" id="closeNew">+</span>
    </button>
    <h2>Ch·ªânh s·ª≠a th√¥ng tin</h2>
    <form id="editProfileForm">
      <div class="form-group">
        <label for="editDisplayName">T√™n hi·ªÉn th·ªã * (3~20 k√≠ t·ª±)</label>
        <input type="text" id="editDisplayName" required minlength="3" maxlength="20">
        <div class="error" id="error-editDisplayName"></div>
      </div>

      <div class="form-group">
        <label for="editPhone">S·ªë ƒëi·ªán tho·∫°i *</label>
        <input type="tel" id="editPhone" required placeholder="0912345678">
        <div class="error" id="error-editPhone"></div>
      </div>

      <hr style="border: none; height: 1px; background-color: #2a2a33; margin: 24px 0;">
      <h3 style="margin-bottom: 16px;">ƒê·ªïi m·∫≠t kh·∫©u (t√πy ch·ªçn)</h3>
      <small style="color: #6b7280; display: block; margin-bottom: 16px;">
        üí° Ch·ªâ ƒëi·ªÅn n·∫øu b·∫°n mu·ªën ƒë·ªïi m·∫≠t kh·∫©u
      </small>

      <div class="form-group">
        <label for="oldPassword">M·∫≠t kh·∫©u c≈©</label>
        <input type="password" id="oldPassword">
        <div class="error" id="error-oldPassword"></div>
      </div>

      <div class="form-group">
        <label for="newPassword">M·∫≠t kh·∫©u m·ªõi</label>
        <input type="password" id="newPassword" placeholder="T·ªëi thi·ªÉu 6 k√Ω t·ª±">
        <div class="error" id="error-newPassword"></div>
      </div>

      <div class="form-group">
        <label for="confirmNewPassword">X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi</label>
        <input type="password" id="confirmNewPassword">
        <div class="error" id="error-confirmNewPassword"></div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-cancel" onclick="editProfileDialog.close()">
          H·ªßy
        </button>
        <button type="submit" class="btn btn-submit">
          L∆∞u thay ƒë·ªïi
        </button>
      </div>
    </form>
  </dialog>

  <dialog id="gopyDialog">
    <button class="btn close" onclick="gopyDialog.close()">
      <span style="font-size: 30px;">+</span>
    </button>
    <h2>G√≥p √Ω / Ph·∫£n h·ªìi</h2>
    <form id="gopyForm">
      <div class="form-group">
        <label for="gopyDisplayName">T√™n c·ªßa b·∫°n</label>
        <input type="text" id="gopyDisplayName" readonly style="background: #0f0f12; cursor: not-allowed; opacity: 0.7;" />
      </div>
      
      <div class="form-group">
        <label for="gopyTieude">Lo·∫°i g√≥p √Ω *</label>
        <select id="gopyTieude" required style="width: 100%; padding: 14px 18px; border: 2px solid var(--border-color); border-radius: 14px; background: rgba(255, 255, 255, 0.03); color: var(--text-primary); font-family: inherit; font-size: 16px;">
          <option value="" disabled selected>-- Ch·ªçn lo·∫°i g√≥p √Ω --</option>
          <option value="error">üêõ Error - B√°o l·ªói</option>
          <option value="lag">‚è±Ô∏è Lag - Hi·ªáu su·∫•t ch·∫≠m</option>
          <option value="more">‚ú® More - Y√™u c·∫ßu th√™m t√≠nh nƒÉng</option>
        </select>
        <div class="error" id="error-gopyTieude"></div>
      </div>

      <div class="form-group">
        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; text-transform: none; font-size: 15px;">
          <input type="checkbox" id="gopyWantReply" style="width: auto; cursor: pointer; accent-color: var(--accent-primary);">
          <span>ƒêƒÉng k√Ω nh·∫≠n ph·∫£n h·ªìi qua Email</span>
        </label>
      </div>
      
      <div class="form-group" id="gopyEmailGroup" style="display: none;">
        <label for="gopyEmail">Email nh·∫≠n ph·∫£n h·ªìi *</label>
        <input type="email" id="gopyEmail" placeholder="example@email.com" />
        <div class="error" id="error-gopyEmail"></div>
      </div>
      
      <div class="form-group">
        <label for="gopyNoidung">N·ªôi dung *</label>
        <textarea id="gopyNoidung" required placeholder="Nh·∫≠p n·ªôi dung g√≥p √Ω c·ªßa b·∫°n..." style="min-height: 200px;"></textarea>
        <div class="error" id="error-gopyNoidung"></div>
      </div>
      
      <div class="form-actions">
        <button type="button" class="btn btn-cancel" onclick="gopyDialog.close()">
          H·ªßy
        </button>
        <button type="submit" class="btn btn-submit">
          G·ª≠i g√≥p √Ω
        </button>
      </div>
    </form>
  </dialog>

  <dialog id="rankingDialog">
    <button class="btn close" onclick="rankingDialog.close()">
      <span style="font-size:30px">+</span>
    </button>
  
    <h2>üèÜ B·∫£ng x·∫øp h·∫°ng ƒë√≥ng g√≥p</h2>
  
    <div style="padding: 24px">
      <ul id="rankingList"></ul>
      <hr>
      <div id="currentUserRank" style="margin-top:12px;font-weight:600"></div>
    </div>
  </dialog>

  <dialog id="userSongsDialog">
    <button class="btn close" onclick="userSongsDialog.close()">
      <span style="font-size: 30px;">+</span>
    </button>
    <h2 id="userSongsTitle">üéµ B√†i h√°t c·ªßa <span id="userSongsName"></span></h2>
    
    <div style="padding: 24px;">
      <div id="userSongsStats" style="
        padding: 16px 20px;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(139, 92, 246, 0.1));
        border: 1px solid var(--accent-primary);
        border-radius: 12px;
        margin-bottom: 20px;
        text-align: center;
        font-weight: 600;
      "></div>
      
      <div id="userSongsList" style="
        max-height: 500px;
        overflow-y: auto;
      "></div>
    </div>
  </dialog>

  <dialog id="favouriteDialog">
    <button class="btn close" onclick="favouriteDialog.close()">
      <span style="font-size: 30px;">+</span>
    </button>
    
    <h2>‚ù§Ô∏è B√†i H√°t Y√™u Th√≠ch</h2>
    
    <div style="padding: 24px 32px 32px 32px;">
      <div id="favouriteStats" style="
        padding: 20px 24px;
        background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(220, 38, 38, 0.1));
        border: 1px solid #ef4444;
        border-radius: 16px;
        margin-bottom: 24px;
        text-align: center;
        font-weight: 600;
      ">
        <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">
          T·ªïng s·ªë b√†i y√™u th√≠ch
        </div>
        <div id="favouriteCount" style="font-size: 32px; font-weight: 800; color: #ef4444;">
          0
        </div>
      </div>
      
      <div id="favouriteList" style="max-height: 500px; overflow-y: auto;">
      </div>
    </div>
  </dialog>

  <dialog id="guideDialog">
    <button class="btn close" onclick="guideDialog.close()">
      <span style="font-size: 30px;">+</span>
    </button>
    <h2>üìñ H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</h2>
    
    <div style="padding: 24px 32px 32px 32px; max-height: 70vh; overflow-y: auto;">
      <div id="guideContent"></div>
    </div>
  </dialog>

  <dialog id="youtubeVideoDialog">
    <button class="btn close" onclick="youtubeVideoDialog.close();">
    <span style="font-size: 30px;">+</span>
    </button>
    <h2><i class="fa-brands fa-youtube"></i> <span id="youtubeVideoSongName"></span></h2>
    
    <div style="padding: 24px 32px 32px 32px;">
      <div id="youtubeVideoIframe"></div>
    </div>
  </dialog>

  <dialog id="spotifyDialog">
    <button class="btn close" onclick="spotifyDialog.close();">
      <span style="font-size: 30px;">+</span>
    </button>
    <h2><i class="fa-brands fa-spotify"></i> <span id="spotifySongName"></span></h2>
    
    <div style="padding: 24px 32px 32px 32px;">
      <div id="spotifyIframe"></div>
    </div>
  </dialog>

  <dialog id="settingsDialog">
    <button class="btn close" onclick="settingsDialog.close()">
      <span style="font-size: 30px;">+</span>
    </button>
    
    <h2><i class="fa-solid fa-gear"></i> C√†i ƒë·∫∑t</h2>
    
    <form id="settingsForm">
      <div style="padding: 24px 32px 32px 32px; max-height: 70vh; overflow-y: auto;">
        
        <!-- THEME SECTION -->
        <div class="settings-section">
          <h3><i class="fa-solid fa-palette"></i> Giao di·ªán</h3>
          <div class="setting-item">
            <div class="setting-label">
              <strong>Theme</strong>
              <small>Ch·ªçn giao di·ªán s√°ng ho·∫∑c t·ªëi</small>
            </div>
            <select id="settingTheme" class="theme-select" style="width: 140px; margin-left: 16px;">
              <option value="dark">üåô T·ªëi</option>
              <option value="light">‚òÄÔ∏è S√°ng</option>
            </select>
          </div>
        </div>
  
        <!-- PERFORMANCE SECTION -->
        <div class="settings-section">
          <h3>
            <i class="fa-solid fa-gauge-high"></i> Hi·ªáu su·∫•t
            <span class="performance-badge">Gi·∫£m lag</span>
          </h3>
          
          <div class="setting-item">
            <div class="setting-label">
              <strong>Hi·ªáu ·ª©ng chuy·ªÉn ƒë·ªông</strong>
              <small>Animations v√† transitions (gi·∫£m lag ~15%)</small>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="settingAnimations" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          
          <div class="setting-item">
            <div class="setting-label">
              <strong>Hi·ªáu ·ª©ng n·ªÅn gradient</strong>
              <small>4 l·ªõp gradient + SVG noise (gi·∫£m lag ~25%)</small>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="settingBackgroundEffects" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          
          <div class="setting-item">
            <div class="setting-label">
              <strong>Hi·ªáu ·ª©ng ph√°t s√°ng</strong>
              <small>Glow effects v√† drop-shadows (gi·∫£m lag ~10%)</small>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="settingGlowEffects" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          
          <div class="setting-item">
            <div class="setting-label">
              <strong>Backdrop Blur</strong>
              <small>L√†m m·ªù n·ªÅn dialog/header (gi·∫£m lag ~30%)</small>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="settingBackdropBlur" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          
          <div class="setting-item">
            <div class="setting-label">
              <strong>Box Shadows</strong>
              <small>B√≥ng ƒë·ªï c√°c elements (gi·∫£m lag ~15%)</small>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="settingBoxShadows" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          
          <div class="setting-item">
            <div class="setting-label">
              <strong>Hi·ªáu ·ª©ng hover ·∫£nh</strong>
              <small>Transform/scale ·∫£nh khi hover (gi·∫£m lag ~8%)</small>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="settingImageHover" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          
          <div class="setting-item">
            <div class="setting-label">
              <strong>Hi·ªáu ·ª©ng hover b·∫£ng</strong>
              <small>Gradient/scale rows khi hover (gi·∫£m lag ~12%)</small>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="settingTableHover" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          
          <div class="setting-item">
            <div class="setting-label">
              <strong>Animation dialog</strong>
              <small>Pop-up effect khi m·ªü dialog (gi·∫£m lag ~5%)</small>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="settingDialogAnimations" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
  
        <!-- INFO SECTION -->
        <div class="settings-section" style="background: rgba(16, 185, 129, 0.05); border-color: rgba(16, 185, 129, 0.3);">
          <h3 style="color: #10b981;"><i class="fa-solid fa-circle-info"></i> G·ª£i √Ω</h3>
          <p style="margin: 0; font-size: 14px; color: var(--text-secondary); line-height: 1.6;">
            üí° <strong>Lag nh·∫π:</strong> T·∫Øt Backdrop Blur + Background Effects<br>
            üöÄ <strong>Lag trung b√¨nh:</strong> T·∫Øt th√™m Box Shadows + Table Hover<br>
            ‚ö° <strong>Lag n·∫∑ng:</strong> T·∫Øt h·∫øt t·∫•t c·∫£ (gi·∫£m lag l√™n ƒë·∫øn 95%)<br>
            üìå C√†i ƒë·∫∑t t·ª± ƒë·ªông l∆∞u v√† √°p d·ª•ng m·ªói khi m·ªü web
          </p>
        </div>
  
      </div>
      
      <div class="settings-actions" style="padding: 20px 32px 32px 32px; border-top: 1px solid var(--border-color);">
        <button type="button" class="btn btn-reset" onclick="resetSettings()">
          <i class="fa-solid fa-rotate-left"></i> ƒê·∫∑t l·∫°i m·∫∑c ƒë·ªãnh
        </button>
        <button type="submit" class="btn btn-submit">
          <i class="fa-solid fa-check"></i> L∆∞u c√†i ƒë·∫∑t
        </button>
      </div>
    </form>
  </dialog>

  <dialog id="historyDialog">
    <button class="btn close" onclick="historyDialog.close()">
      <span style="font-size: 30px;">+</span>
    </button>
    
    <h2><i class="fa-solid fa-clock-rotate-left"></i> L·ªãch s·ª≠ th√™m b√†i h√°t</h2>
    
    <div style="padding: 24px 32px 32px 32px;">
      <!-- Th·ªëng k√™ -->
      <div id="historyStats"></div>
      
      <!-- Danh s√°ch -->
      <div id="historyList"></div>
    </div>
  </dialog>

  <dialog id="albumDialog">
    <button class="btn close" onclick="albumDialog.close()">
      <span style="font-size: 30px;">+</span>
    </button>
    <h2><i class="fa-solid fa-compact-disc"></i> Danh s√°ch Album</h2>
    
    <div style="padding: 24px 32px 32px 32px;">
      <div id="albumStats"></div>
      <div id="albumList"></div>
    </div>
  </dialog>
  
  <script src="js/main.js"></script>
  <script src="js/guide.js"></script>
  <script src="js/settings.js"></script>
  <script type="module" src="js/supabase-client.js"></script>
  <script type="module" src="js/favourite.js"></script>
  <script type="module" src="js/module.js"></script>
  <script type="module" src="js/update.js"></script>

</body>

</html>